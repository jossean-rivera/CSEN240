Running Python script: knee-osteo-l2-1e-3_lr_9e-5_dense_layer.py
/WAVE/projects2/CSEN-240-Fall25/jriveramiranda/knee-osteo-l2-1e-3_lr_9e-5_dense_layer.py:53: FutureWarning: 

Passing `palette` without assigning `hue` is deprecated and will be removed in v0.14.0. Assign the `x` variable to `hue` and set `legend=False` for the same effect.

  sns.countplot(data=df, x="label", palette="viridis", ax=ax)
2025-11-29 21:12:53.538220: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
Modeling Knee Osteoarthritis
============================
Current test:
- L2 Regularization with penalty 1e-3
- Set learning rate to 9e-5
- Add one more dense layer with L2 regularization
============================
Data Frame dimentions: (3780, 2)
Dupplicated sum: 0
IsNull sum:
image_path    0
label         0
dtype: int64
Data Frame Info
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 3780 entries, 0 to 3779
Data columns (total 2 columns):
 #   Column      Non-Null Count  Dtype 
---  ------      --------------  ----- 
 0   image_path  3780 non-null   object
 1   label       3780 non-null   object
dtypes: object(2)
memory usage: 59.2+ KB
Unique labels: ['Normal' 'Osteopenia' 'Osteoporosis']
Label counts: label
Normal          1260
Osteopenia      1260
Osteoporosis    1260
Name: count, dtype: int64

Class distribution after oversampling:
category_encoded
0    1260
1    1260
2    1260
Name: count, dtype: int64
                                            image_path  category_encoded
0                         ./train/Normal/N4_aug_5.jpeg                 0
1                        ./train/Normal/N22_aug_4.jpeg                 0
2                        ./train/Normal/N15_aug_4.jpeg                 0
3                        ./train/Normal/Normal 290.png                 0
4                       ./train/Normal/Normal 169.JPEG                 0
...                                                ...               ...
3775               ./train/Osteoporosis/OS2_aug_0.jpeg                 2
3776  ./train/Osteoporosis/Osteoporosis 473_aug_0.jpeg                 2
3777              ./train/Osteoporosis/OS49_aug_0.jpeg                 2
3778  ./train/Osteoporosis/Osteoporosis 311_aug_0.jpeg                 2
3779         ./train/Osteoporosis/Osteoporosis 518.jpg                 2

[3780 rows x 2 columns]
check
(3024, 2)
(756, 2)
(378, 2)
(378, 2)
Found 3024 validated image filenames belonging to 3 classes.
Found 378 validated image filenames belonging to 3 classes.
Found 378 validated image filenames belonging to 3 classes.
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
W0000 00:00:1764479576.885666 3226659 gpu_device.cc:2342] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Num GPUs Available:  0
Epoch 1/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1490s 8s/step - accuracy: 0.5060 - loss: 2.4506 - val_accuracy: 0.3757 - val_loss: 2.8967
Epoch 2/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1483s 8s/step - accuracy: 0.5717 - loss: 2.1778 - val_accuracy: 0.6243 - val_loss: 1.9261
Epoch 3/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1482s 8s/step - accuracy: 0.6219 - loss: 2.0312 - val_accuracy: 0.6085 - val_loss: 2.1633
Epoch 4/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1481s 8s/step - accuracy: 0.6335 - loss: 1.9398 - val_accuracy: 0.6005 - val_loss: 2.1642
Epoch 5/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1479s 8s/step - accuracy: 0.6797 - loss: 1.8289 - val_accuracy: 0.6799 - val_loss: 2.1990
Epoch 6/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1483s 8s/step - accuracy: 0.6667 - loss: 1.7890 - val_accuracy: 0.5926 - val_loss: 2.1448
Epoch 7/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1483s 8s/step - accuracy: 0.7167 - loss: 1.7097 - val_accuracy: 0.6905 - val_loss: 1.7900
Epoch 8/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1484s 8s/step - accuracy: 0.7412 - loss: 1.6098 - val_accuracy: 0.6376 - val_loss: 1.8961
Epoch 9/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1482s 8s/step - accuracy: 0.7182 - loss: 1.6160 - val_accuracy: 0.6587 - val_loss: 1.8585
Epoch 10/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1483s 8s/step - accuracy: 0.7357 - loss: 1.5547 - val_accuracy: 0.6614 - val_loss: 1.8372
Epoch 11/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1481s 8s/step - accuracy: 0.7688 - loss: 1.4881 - val_accuracy: 0.6852 - val_loss: 1.6903
Epoch 12/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1483s 8s/step - accuracy: 0.7941 - loss: 1.3884 - val_accuracy: 0.6508 - val_loss: 1.8700
Epoch 13/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1484s 8s/step - accuracy: 0.8196 - loss: 1.3367 - val_accuracy: 0.6561 - val_loss: 1.8847
Epoch 14/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1484s 8s/step - accuracy: 0.8093 - loss: 1.3294 - val_accuracy: 0.6984 - val_loss: 1.7865
Epoch 15/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1482s 8s/step - accuracy: 0.8466 - loss: 1.2328 - val_accuracy: 0.7328 - val_loss: 1.6338
Epoch 16/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1482s 8s/step - accuracy: 0.8449 - loss: 1.1813 - val_accuracy: 0.7090 - val_loss: 1.6979
Epoch 17/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1481s 8s/step - accuracy: 0.8596 - loss: 1.1656 - val_accuracy: 0.6270 - val_loss: 2.3119
Epoch 18/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1486s 8s/step - accuracy: 0.8568 - loss: 1.1640 - val_accuracy: 0.6878 - val_loss: 1.7307
Epoch 19/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1484s 8s/step - accuracy: 0.8748 - loss: 1.0957 - val_accuracy: 0.6799 - val_loss: 1.6380
Epoch 20/250
189/189 ━━━━━━━━━━━━━━━━━━━━ 1485s 8s/step - accuracy: 0.8834 - loss: 1.0466 - val_accuracy: 0.4286 - val_loss: 3.5042
24/24 ━━━━━━━━━━━━━━━━━━━━ 65s 3s/step 

PPO Loss on Validation Data: -0.9973358
24/24 ━━━━━━━━━━━━━━━━━━━━ 64s 3s/step 
Classification Report:
              precision    recall  f1-score   support

           0       0.80      0.77      0.79       126
           1       0.69      0.92      0.79       126
           2       0.82      0.59      0.69       126

    accuracy                           0.76       378
   macro avg       0.77      0.76      0.75       378
weighted avg       0.77      0.76      0.75       378
